<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Login</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
  />
  <style>
    .toast {
      opacity: 0;
      transform: translateY(-10px);
      transition: opacity 0.4s ease, transform 0.4s ease;
    }
    .toast.show {
      opacity: 1;
      transform: translateY(0);
    }
    /* Animated dots inside success toast */
    .dots {
      display: inline-block;
      margin-left: 6px;
    }
    .dot {
      display: inline-block;
      width: 6px;
      height: 6px;
      margin: 0 2px;
      background-color: currentColor;
      border-radius: 50%;
      opacity: 0.3;
      animation: blink 1.4s infinite;
    }
    .dot:nth-child(2) { animation-delay: 0.2s; }
    .dot:nth-child(3) { animation-delay: 0.4s; }
    @keyframes blink {
      0%, 80%, 100% { opacity: 0.3; }
      40% { opacity: 1; }
    }
  </style>
</head>
<body class="bg-gray-50 flex items-center justify-center min-h-screen px-4">

  <div class="w-full md:w-96">
    <!-- Logo -->
    <div class="flex justify-center mb-6">
      <img src="https://via.placeholder.com/100x100" alt="Brand Logo" class="h-20 w-20">
    </div>

    <!-- Card -->
    <div class="bg-white shadow rounded-xl p-6">
      <h2 class="text-3xl font-bold text-gray-900 text-center mb-1">Welcome Back</h2>
      <p class="text-gray-500 text-center">Login to access your escrow account</p>

      <!-- Form -->
      <form id="loginForm" class="mt-4 space-y-4">
        
        <!-- Email -->
        <div>
          <label class="block text-sm font-medium text-gray-700">Email Address</label>
          <input type="email" id="email" placeholder="Email Address"
            class="mt-1 block w-full rounded-lg border border-gray-300 placeholder-gray-400 focus:border-[#1A73E8] focus:ring-[#1A73E8] p-2">
          <p class="mt-1 text-sm text-red-600 hidden" id="emailError"></p>
        </div>

        <!-- Password -->
        <div>
          <label class="block text-sm font-medium text-gray-700">Password</label>
          <input type="password" id="password" placeholder="Password"
            class="mt-1 block w-full rounded-lg border border-gray-300 placeholder-gray-400 focus:border-[#1A73E8] focus:ring-[#1A73E8] p-2">
          <p class="mt-1 text-sm text-red-600 hidden" id="passwordError"></p>
          <div class="flex justify-between mt-1">
            <label class="flex items-center text-sm text-gray-700">
              <input type="checkbox" id="rememberMe" class="h-4 w-4 text-green-600 border-gray-300 rounded">
              <span class="ml-2">Remember me</span>
            </label>
            <a href="#" class="text-sm text-[#1A73E8]">Forgot password?</a>
          </div>
        </div>

        <!-- Button -->
        <button type="submit"
          class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg shadow-sm transition">
          Login
        </button>
      </form>

      <!-- Footer -->
      <p class="mt-6 text-center text-sm text-gray-600">
        Donâ€™t have an account?
        <a href="signup.html" class="text-[#1A73E8] font-medium">Sign up</a>
      </p>
    </div>
  </div>

  <!-- Toast Container -->
  <div id="toastContainer" class="fixed top-4 right-4 space-y-2 z-50"></div>

  <script>
    const form = document.getElementById('loginForm');
    const toastContainer = document.getElementById('toastContainer');

    // Toast helper
    function showToast(message, type, withDots = false) {
      const toast = document.createElement('div');
      toast.className = `toast flex items-center px-4 py-2 rounded-lg shadow-md ${
        type === 'success' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'
      }`;
      toast.innerHTML = `
        <i class="fa-solid ${type === 'success' ? 'fa-check-circle' : 'fa-times-circle'} mr-2"></i>
        <span>${message}</span>
        ${withDots ? '<span class="dots"><span class="dot"></span><span class="dot"></span><span class="dot"></span></span>' : ''}
      `;
      toastContainer.appendChild(toast);

      setTimeout(() => toast.classList.add('show'), 100);
      setTimeout(() => {
        toast.classList.remove('show');
        setTimeout(() => toast.remove(), 400);
      }, 2500);
    }

    form.addEventListener('submit', (e) => {
      e.preventDefault();

      // Reset errors
      document.getElementById('emailError').classList.add('hidden');
      document.getElementById('passwordError').classList.add('hidden');

      const email = document.getElementById('email').value.trim();
      const password = document.getElementById('password').value;

      let hasError = false;

      const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;
      if (!emailRegex.test(email)) {
        document.getElementById('emailError').textContent = "Enter a valid email.";
        document.getElementById('emailError').classList.remove('hidden');
        hasError = true;
      }

      if (password.length < 8) {
        document.getElementById('passwordError').textContent = "Password must be at least 8 characters.";
        document.getElementById('passwordError').classList.remove('hidden');
        hasError = true;
      }

      if (hasError) return;

      // Retrieve saved users
      let users = JSON.parse(localStorage.getItem('users')) || [];

      if (users.length === 0) {
        showToast("No account found, please sign up", "error");
        return;
      }

      const matchedUser = users.find(u => u.email === email && u.password === password);

      if (!matchedUser) {
        showToast("Incorrect email or password", "error");
        return;
      }

      // Save session
      sessionStorage.setItem('loggedInUser', JSON.stringify(matchedUser));

      // Success toast with dots
      showToast("Login successful, redirecting to dashboard", "success", true);

      setTimeout(() => {
        window.location.href = "dashboard.html";
      }, 3000);
    });

    // Reset UI on load
    window.addEventListener("load", () => {
      form.reset();
      toastContainer.innerHTML = "";
    });
  </script>
</body>
</html>